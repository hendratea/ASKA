var table_ijin_inputdata;function table_InputIjin(){var a;a=baseURL+"get_inputijin",table_ijin_inputdata=$("#dt_ijin_inputdata").DataTable({order:[5,"asc"],destroy:!0,iDisplayLength:10,processing:!0,searching:!0,ajax:{url:a,type:"GET"},language:{processing:'<div class="loader"><div class="m-t-30"><img class="zmdi-hc-spin" src="'+baseURL+'assets/template/images/loader.svg" width="48" height="48" alt="Aero"></div><p>Processing...</p></div>'}})}function dateRange(a,t,n=1){const i=[];let e=new Date(a);for(;e<=new Date(t);)i.push(new Date(e)),e.setUTCDate(e.getUTCDate()+n);return i}function hitungSelisihHari(){let a,t,n,i,e,l=$("#tglAwal").val(),o=$("#tglAkhir").val(),r=moment(l,"YYYY-MM-DD"),u=moment(o,"YYYY-MM-DD"),s=u.diff(r,"days")+1,c=dateRange(r,u),d=["2024-12-25"];for(i=0;i<d.length;i++)for(e=0;e<c.length;e++)a=c[e],t=moment(a).format("YYYY-MM-DD"),n=moment(a).format("dddd"),d[i]!=t?"Sunday"==n&&0==i&&s--:s--;$("#lamaIjin").val(s+" hari")}function emptyControlBox(){$("#lamaCuti").val("1 hari"),$("#tglDibuat,#tglAwal,#tglAkhir").val(moment().format("YYYY-MM-DD")),$("#jenisIjin").select2("val",""),$("#alasan").val("")}function btnSaveData(){let a=$("#tglDibuat").val(),t=moment(a).format("YYYY-MM-DD"),n=moment(t).locale("id").format("YYYY-MM-DD");Swal.fire({title:"SIMPAN pengajuan Ijin untuk tanggal",text:n,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya",cancelButtonText:"Tidak"}).then((a=>{if(a.isConfirmed){var t=baseURL+"save_inputijin",i=$.param({ajax_IDPEG:$("#idPegawai").val(),ajax_r_ijin:$("#jenisIjin").val(),ajax_tgl_dibuat:moment($("#tglDibuat").val()).format("YYYY-MM-DD"),ajax_tgl_awal:moment($("#tglAwal").val()).format("YYYY-MM-DD"),ajax_tgl_akhir:moment($("#tglAkhir").val()).format("YYYY-MM-DD"),ajax_jml_hari:$("#lamaIjin").val(),ajax_alasan:$("#alasan").val()});$.ajax({url:t,type:"POST",data:i,dataType:"JSON",success:function(a){1==a.statusInsertToDb?Swal.fire({title:"BERHASIL tersimpan",text:"pengajuan Ijin untuk tanggal "+n,icon:"success",timer:3e3}).then((function(){table_ijin_inputdata.ajax.reload(),emptyControlBox()})):2==a.statusInsertToDb?Swal.fire({title:"GAGAL",text:"pengajuan Ijin untuk tanggal "+n+" SUDAH ADA",icon:"error"}):(Swal.fire({title:"GAGAL tersimpan",text:"pengajuan Ijin untuk tanggal "+n,icon:"warning"}),table_ijin_inputdata.ajax.reload())},error:function(){Swal.fire({title:"GAGAL tersimpan",text:"pengajuan Ijin untuk tanggal "+n,icon:"error"}),table_ijin_inputdata.ajax.reload()}})}}))}function btnUpdateData(){let a=moment($("#tglDibuat").val()).format("YYYY-MM-DD");Swal.fire({title:"SIMPAN perubahan pengajuan Ijin untuk tanggal",text:a,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya",cancelButtonText:"Tidak"}).then((t=>{if(t.isConfirmed){$("#btnUpdate").hide(),$("#btnCancel").hide(),$("#btnSubmit").show(),$("#btnReset").show();var n=baseURL+"update_inputijin",i=$.param({ajax_IDPEG:$("#idPegawai").val(),ajax_r_ijin:$("#jenisIjin").val(),ajax_tgl_dibuat:$("#tglDibuat").val(),ajax_tgl_awal:$("#tglAwal").val(),ajax_tgl_akhir:$("#tglAkhir").val(),ajax_jml_hari:$("#lamaIjin").val(),ajax_alasan:$("#alasan").val()});$.ajax({url:n,type:"POST",data:i,dataType:"JSON",success:function(t){1==t.statusUpdateToDb?Swal.fire({title:"BERHASIL tersimpan perubahan",text:"pengajuan Ijin untuk tanggal "+a,icon:"success",timer:3e3}).then((function(){table_ijin_inputdata.ajax.reload(),emptyControlBox()})):(Swal.fire({title:"GAGAL tersimpan perubahan",text:"pengajuan Ijin untuk tanggal "+a,icon:"warning"}),table_ijin_inputdata.ajax.reload())},error:function(){Swal.fire({title:"GAGAL tersimpan perubahan",text:"pengajuan Ijin untuk tanggal "+a,icon:"error"}),table_ijin_inputdata.ajax.reload()}})}}))}function confirmUpdateData(a,t){let n=moment(a).format("YYYY-MM-DD");Swal.fire({title:"UBAH pengajuan Ijin untuk tanggal",text:n,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya",cancelButtonText:"Tidak"}).then((i=>{if(i.isConfirmed){var e=baseURL+"get_inputijin_forupdate",l={ajax_tgl_dibuat:a,ajax_IDPEG:t};$.getJSON(e,l).done((function(a){a?($("#btnUpdate").show(),$("#btnCancel").show(),$("#btnSubmit").hide(),$("#btnReset").hide(),$("#lamaIjin").val(a.jml_hari),$("#tglDibuat").val(a.tgl_dibuat),$("#tglAwal").val(a.tgl_awal),$("#tglAkhir").val(a.tgl_akhir),$("#jenisIjin").select2("val",a.r_ijin),$("#alasan").val(a.alasan)):Swal.fire({title:"GAGAL",text:"Request Data "+n+", Status : Invalid return JSON",icon:"error"})})).fail((function(a,t,i){var e=t+", "+i;Swal.fire({title:"GAGAL",text:"Request Data "+n+", Status : "+e,icon:"error"})}))}}))}function confirmDeleteData(a){let t=moment($("#tglDibuat").val()).format("YYYY-MM-DD");Swal.fire({title:"HAPUS pengajuan Ijin untuk tanggal",text:t,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya",cancelButtonText:"Tidak"}).then((n=>{if(n.isConfirmed){var i=baseURL+"delete_inputijin",e=$.param({ajax_tgl_dibuat:a});$.ajax({url:i,type:"POST",data:e,dataType:"JSON",success:function(a){1==a.statusDeleteToDb?Swal.fire({title:"BERHASIL terhapus",text:"pengajuan Ijin untuk tanggal "+t,icon:"success",timer:3e3}).then((function(){table_ijin_inputdata.ajax.reload()})):(Swal.fire({title:"GAGAL terhapus",text:"pengajuan Ijin untuk tanggal "+t,icon:"warning"}),table_ijin_inputdata.ajax.reload())},error:function(){Swal.fire({title:"GAGAL terhapus",text:"pengajuan Ijin untuk tanggal "+t,icon:"error"}),table_ijin_inputdata.ajax.reload()}})}}))}function validationForm(a,t,n,i){return""==$(a).val()?($(t).css({border:"1px solid red",color:"red"}),$(a).addClass("form-control-danger"),$(n).html(i+" harus diisi"),"noValid"):($(t).css({border:"0px solid red",color:"red"}),$(a).removeClass("form-control-danger"),$(n).html(""),"Valid")}function checkValidControlForm(){return validationFormValid=[],statusValidjenisIjin=validationForm("#jenisIjin","#boxIconjenisIjin","#msgErrjenisIjin","Jenis Ijin"),statusValidalasan=validationForm("#alasan","#boxIconalasan","#msgErralasan","Alasan"),validationFormValid.push(statusValidjenisIjin,statusValidalasan),!(validationFormValid.indexOf("noValid")>-1)}$((function(){$(".datepicker").bootstrapMaterialDatePicker({format:"YYYY-MM-DD",weekStart:1,time:!1,minDate:new Date}),$(".datetimepicker").bootstrapMaterialDatePicker({format:"dddd DD MMMM YYYY - HH:mm",weekStart:1,minDate:new Date}),$(".timepicker").bootstrapMaterialDatePicker({format:"HH:mm",date:!1,minTime:new Date}),table_InputIjin()})),$("#tglDibuat").on("change",(function(){tglDibuat=$("#tglDibuat").val(),$("#tglAkhir,#tglAwal").val(tglDibuat),$("#tglAkhir,#tglAwal").bootstrapMaterialDatePicker("setMinDate",tglDibuat),$("#lamaCuti").val("1 hari")})),$("#tglAwal").on("change",(function(){tglAwal=$("#tglAwal").val(),$("#tglAkhir").val(tglAwal),$("#tglAkhir").bootstrapMaterialDatePicker("setMinDate",tglAwal),$("#lamaCuti").val("1 hari")})),$("#tglAkhir").on("change",(function(a){hitungSelisihHari()})),$("#btnReset").click((function(){emptyControlBox(),$("#btnCancel").click()})),$("#btnCancel").click((function(){$("#btnUpdate,#btnCancel").hide(),$("#btnSubmit,#btnReset").show(),emptyControlBox()})),$("#btnSubmit").click((function(){checkValidControlForm()&&btnSaveData()})),$("#btnUpdate").click((function(){checkValidControlForm()&&btnUpdateData()}));